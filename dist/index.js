!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("@material-ui/core"),require("@material-ui/core/SvgIcon")):"function"==typeof define&&define.amd?define("mui-feedback-dialog",["react","@material-ui/core","@material-ui/core/SvgIcon"],t):"object"==typeof exports?exports["mui-feedback-dialog"]=t(require("react"),require("@material-ui/core"),require("@material-ui/core/SvgIcon")):e["mui-feedback-dialog"]=t(e.react,e["@material-ui/core"],e["@material-ui/core/SvgIcon"])}(window,(function(e,t,r){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=7)}([function(t,r){t.exports=e},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";var n=r(1);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=a.default.memo(a.default.forwardRef((function(t,r){return a.default.createElement(i.default,(0,o.default)({ref:r},t),e)})));0;return r.muiName=i.default.muiName,r};var o=n(r(11)),a=n(r(0)),i=n(r(5))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachHandlers=void 0,t.attachHandlers=(e,t,r,n,o)=>{const a=e=>{const r=(e=e||window.event).relatedTarget||e.toElement;r&&"HTML"!==r.nodeName&&r!==t.current||o(e)};return e.current.addEventListener("mousedown",r),t.current.addEventListener("mousemove",n),t.current.addEventListener("mouseup",o),t.current.addEventListener("mouseout",a),e.current.addEventListener("touchstart",r),t.current.addEventListener("touchmove",n),t.current.addEventListener("touchend",o),t.current.addEventListener("touchcancel",o),()=>{e.current&&(e.current.removeEventListener("mousedown",r),t.current.removeEventListener("mousemove",n),t.current.removeEventListener("mouseup",o),t.current.removeEventListener("mouseout",a),e.current.removeEventListener("touchstart",r),t.current.removeEventListener("touchmove",n),t.current.removeEventListener("touchend",o),t.current.removeEventListener("touchcancel",o))}}},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFeedbackDialogController=void 0;const n=r(0),o=r(15),a=r(16),i=r(17),l=r(18),c=r(19);t.useFeedbackDialogController=function({onClose:e,open:t,onSubmit:r,tenantId:u}){const[s,d]=n.useState(""),[f,h]=n.useState(""),[p,m]=n.useState(!1),v=n.useRef(null),b=n.useRef(null),g=n.useRef(null),y=n.useRef(null),[x,E]=n.useState("pen");a.usePencil("pen"===x&&b,y,g),l.useBlackBox("blackbox"===x&&b,y,g),i.useEraser("eraser"===x&&b,y,g),n.useEffect(()=>{m(!1),d(""),h(""),v.current&&(v.current.getContext("2d").clearRect(0,0,v.current.clientWidth,v.current.clientHeight),b.current.getContext("2d").clearRect(0,0,v.current.clientWidth,v.current.clientHeight))},[t]);const w=e=>{g.current&&(g.current.style.visibility="rectangle"===e?"hidden":"visible",g.current.style.width=("eraser"===e?10:3)+"px",g.current.style.border="pen"===e?"none":"solid 1px black",g.current.style.height=("eraser"===e?10:3)+"px",g.current.style.borderRadius="pen"===e?"50%":"0",g.current.style.backgroundColor="pen"===e?"red":"white"),E(e)};return{canSubmit:s.length,description:s,email:f,onEmailChange:e=>h(e.target.value),onDescriptionChange:e=>d(e.target.value),includeSS:p,closeDialog:e,submit:()=>{if(s.length){let t=null;if(p){v.current.getContext("2d").drawImage(b.current,0,0),t=v.current.toDataURL("webp",.9)}u&&c.postRequest("https://feedback.fochlac.com/api/reports",{description:s,screenshot:t,email:f,tenantId:u}),r&&r({description:s,screenshot:t,email:f}),e()}},canvasRef:v,penRef:g,dialogRef:y,drawCanvasRef:b,onSSChange:e=>{const t=e.target.checked;t?(y.current.style.visibility="hidden",o.takeScreenshotCanvas(v.current).then(()=>m(t)).catch(()=>m(!1)).then(()=>{b.current.width=v.current.width,b.current.height=v.current.height,b.current.style.width=v.current.style.width,b.current.getContext("2d").setTransform(v.current.getContext("2d").getTransform()),y.current.style.visibility="visible"})):m(t)},resetDrawing:()=>{if(b.current){b.current.getContext("2d").clearRect(0,0,b.current.width,b.current.height)}},useEraser:()=>w("eraser"),useBlackBox:()=>w("blackbox"),usePen:()=>w("pen"),isBlackboxActive:"blackbox"===x,isPenActive:"pen"===x,isEraserActive:"eraser"===x}}},function(e,t,r){e.exports=r(8)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9);Object.defineProperty(t,"FeedbackDialog",{enumerable:!0,get:function(){return n.FeedbackDialog}});var o=r(6);Object.defineProperty(t,"useFeedbackDialogController",{enumerable:!0,get:function(){return o.useFeedbackDialogController}})},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FeedbackDialog=void 0;const o=n(r(0)),a=r(4),i=n(r(10)),l=n(r(12)),c=r(13),u=n(r(14)),s=r(6),d=n(r(20)),f=r(4),h={title:"Give Feedback",cancel:"Cancel",submit:"Submit Feedback",contentText:"Thank you for giving feedback. Please describe any issue as detailed as possible. If it is okay to contact you for more details, please write down your email address as well.",feedbackLabel:"Description",emailLabel:"Email Address",includeScreenshot:"Attach Screenshot",tooltipPen:"Pen",tooltipEraser:"Eraser",tooltipBlackbox:"Black Rectangle",tooltipReset:"Reset Drawings",tooltipSubmit:"Please enter a short description.",screenshotInfo:'If you select "Attach Screenshot", the browser will ask you to share your screen. Please select the current browser tab, of which a single screenshot will be taken and displayed for preview below.'};t.FeedbackDialog=({open:e,onClose:t,text:r,onSubmit:n,tenantId:p,className:m})=>{const{closeDialog:v,submit:b,canSubmit:g,includeSS:y,onSSChange:x,canvasRef:E,drawCanvasRef:w,dialogRef:C,resetDrawing:M,useEraser:k,usePen:P,isPenActive:D,isEraserActive:R,isBlackboxActive:_,useBlackBox:S,description:L,onDescriptionChange:j,email:O,onEmailChange:B,penRef:T}=s.useFeedbackDialogController({onClose:t,open:e,onSubmit:n,tenantId:p}),I={...h,...r||{}};return o.default.createElement(a.Dialog,{open:e,maxWidth:"md",onClose:v,ref:C,style:{marginTop:48},classes:{container:m}},o.default.createElement(a.DialogTitle,null,I.title),o.default.createElement(a.DialogContent,null,o.default.createElement(a.DialogContentText,null,I.contentText),o.default.createElement(a.TextField,{style:{marginBottom:8},autoFocus:!0,value:O,onChange:B,margin:"dense",id:"email",InputLabelProps:{shrink:!0},label:I.emailLabel,fullWidth:!0}),o.default.createElement(a.TextField,{style:{overflowY:"visible",height:"auto"},autoFocus:!0,value:L,onChange:j,margin:"dense",id:"description",InputLabelProps:{shrink:!0},label:I.feedbackLabel,multiline:!0,required:!0,rows:4,fullWidth:!0}),!y&&o.default.createElement(a.Box,{style:{display:"flex",padding:8,margin:"8px 0",background:f.colors.blue[50],color:f.colors.blue[900]}},o.default.createElement(d.default,{style:{marginRight:8}}),o.default.createElement(a.Typography,null,I.screenshotInfo)),o.default.createElement(a.Box,{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:4}},o.default.createElement(a.FormControlLabel,{control:o.default.createElement(a.Checkbox,{checked:y,onChange:x,name:"checkedB",color:"primary"}),label:I.includeScreenshot}),y&&o.default.createElement(a.ButtonGroup,{size:"small"},o.default.createElement(a.Tooltip,{arrow:!0,title:I.tooltipPen},o.default.createElement(a.Button,{onClick:P,variant:D?"contained":"outlined",color:D?"primary":"default",disableElevation:!0,disableRipple:!0},o.default.createElement(i.default,null))),o.default.createElement(a.Tooltip,{arrow:!0,title:I.tooltipEraser},o.default.createElement(a.Button,{onClick:k,variant:R?"contained":"outlined",color:R?"primary":"default",disableElevation:!0,disableRipple:!0},o.default.createElement(c.EraserIcon,null))),o.default.createElement(a.Tooltip,{arrow:!0,title:I.tooltipBlackbox},o.default.createElement(a.Button,{onClick:S,variant:_?"contained":"outlined",color:_?"primary":"default",disableElevation:!0,disableRipple:!0},o.default.createElement(u.default,null))),o.default.createElement(a.Tooltip,{arrow:!0,title:I.tooltipReset},o.default.createElement(a.Button,{onClick:M},o.default.createElement(l.default,null))))),o.default.createElement(a.Collapse,{in:y,timeout:"auto",enter:!1,style:{display:"flex",justifyContent:"center"}},o.default.createElement("div",{style:{border:"solid 1px black",position:"relative",overflow:"hidden"}},o.default.createElement("div",{ref:T,style:{position:"absolute",pointerEvents:"none",zIndex:1,transform:"translate(-50%, -50%)",visibility:"visible",width:3,height:3,borderRadius:"50%",backgroundColor:"red"}}),o.default.createElement("canvas",{ref:E,width:550,height:350}),o.default.createElement("canvas",{style:{position:"absolute",top:0,left:0},ref:w,width:550,height:350})))),o.default.createElement(a.DialogActions,null,o.default.createElement(a.Button,{onClick:v,color:"default",className:"cancel-button"},I.cancel),o.default.createElement(a.Tooltip,{arrow:!0,title:I.tooltipSubmit,placement:"top",disableFocusListener:!!g,disableHoverListener:!!g,disableTouchListener:!!g},o.default.createElement(a.Button,{onClick:b,disabled:!g,component:"div",color:"primary",className:"submit-button"},I.submit))))}},function(e,t,r){"use strict";var n=r(1);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(r(0)),a=(0,n(r(2)).default)(o.default.createElement("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Create");t.default=a},function(e,t){function r(){return e.exports=r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r.apply(this,arguments)}e.exports=r},function(e,t,r){"use strict";var n=r(1);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(r(0)),a=(0,n(r(2)).default)(o.default.createElement("path",{d:"M7.11 8.53L5.7 7.11C4.8 8.27 4.24 9.61 4.07 11h2.02c.14-.87.49-1.72 1.02-2.47zM6.09 13H4.07c.17 1.39.72 2.73 1.62 3.89l1.41-1.42c-.52-.75-.87-1.59-1.01-2.47zm1.01 5.32c1.16.9 2.51 1.44 3.9 1.61V17.9c-.87-.15-1.71-.49-2.46-1.03L7.1 18.32zM13 4.07V1L8.45 5.55 13 10V6.09c2.84.48 5 2.94 5 5.91s-2.16 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93s-3.05-7.44-7-7.93z"}),"RotateLeft");t.default=a},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.EraserIcon=void 0;const o=n(r(5)),a=n(r(0));t.EraserIcon=e=>a.default.createElement(o.default,Object.assign({viewBox:"0 0 500 500",width:"24",height:"24"},e),a.default.createElement("g",{style:{strokeLinecap:"round",fill:"currentColor",stroke:"currentColor",strokeWidth:20}},a.default.createElement("path",{d:"M 185.739 20.927 L 335.739 20.927 C 343.664 21.146 351.694 22.962 359.03 26.012 C 366.367 29.062 373.011 33.347 378.165 38.501 C 383.32 43.655 387.604 50.299 390.654 57.636 C 391.113 58.739 393.006 66.806 394.09 80.254 L 398.169 389.619 C 284.959 503.246 403.401 384.4 295.646 492.952 L 185.739 490.927 C 177.814 490.709 169.784 488.893 162.448 485.842 C 155.111 482.792 148.467 478.507 143.313 473.353 C 138.158 468.199 133.874 461.555 130.824 454.218 C 127.774 446.881 125.957 438.852 125.739 430.927 L 125.739 80.927 C 125.957 73.002 127.774 64.972 130.824 57.636 C 133.874 50.299 138.158 43.655 143.313 38.501 C 148.467 33.346 155.111 29.062 162.448 26.012 C 169.784 22.962 177.814 21.145 185.739 20.927 Z M 377.517 245.011 L 145.334 250.737 L 145.739 430.927 C 145.521 436.809 146.503 441.933 148.513 446.56 C 150.523 451.187 153.561 455.317 157.455 459.211 C 161.349 463.105 166.289 465.333 170.916 467.343 C 175.543 469.354 179.857 471.145 185.739 470.927 L 287.951 471.737 C 378.273 381.036 289.307 470.752 378.979 379.899 L 377.517 245.011 Z",transform:"matrix(0.707107, 0.707106, -0.707106, 0.707107, 248.084396, -109.411057)"})))},function(e,t,r){"use strict";var n=r(1);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(r(0)),a=(0,n(r(2)).default)(o.default.createElement("path",{d:"M6 6h12v12H6z"}),"Stop");t.default=a},function(e,t,r){"use strict";async function n(){const e=screen.width*(window.devicePixelRatio||1),t=screen.height*(window.devicePixelRatio||1),r=[];let n;try{n=await function(e){const t=navigator;if(t.mediaDevices&&t.mediaDevices.getDisplayMedia)return t.mediaDevices.getDisplayMedia(e);if(t.getDisplayMedia)return t.getDisplayMedia(e);if(t.webkitGetDisplayMedia)return t.webkitGetDisplayMedia(e);if(t.mozGetDisplayMedia)return t.mozGetDisplayMedia(e);throw new Error("getDisplayMedia is not defined")}({audio:!1,video:{displaySurface:"browser",width:e,height:t,frameRate:4}})}catch(e){r.push(e)}try{n=await function(e){const t=navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia)return t.mediaDevices.getUserMedia(e);if(t.getUserMedia)return t.getUserMedia(e);if(t.webkitGetUserMedia)return t.webkitGetUserMedia(e);if(t.mozGetUserMedia)return t.mozGetUserMedia(e);throw new Error("getUserMedia is not defined")}({audio:!1,video:{mandatory:{chromeMediaSource:"tab",minWidth:e,maxWidth:e,minHeight:t,maxHeight:t}}})}catch(e){r.push(e)}return r.length&&console.debug(...r),n}Object.defineProperty(t,"__esModule",{value:!0}),t.takeScreenshotCanvas=void 0,t.takeScreenshotCanvas=async function(e){const t=await n();if(!t)return Promise.reject();const r=document.createElement("video"),o=await new Promise(n=>{r.onloadedmetadata=async()=>{r.play(),await new Promise(e=>setTimeout(e,251)),r.pause();const t=e.getContext("2d");e.width=r.videoWidth,e.height=r.videoHeight,t.drawImage(r,0,0,r.videoWidth,r.videoHeight),r.videoWidth>r.videoHeight?e.style.width="100%":e.style.width=Math.ceil(450/r.videoHeight*r.videoWidth)+"px",n(e)},r.srcObject=t});return t.getTracks().forEach((function(e){e.stop()})),o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.usePencil=void 0;const n=r(0),o=r(3);t.usePencil=(e,t,r)=>{let a=null;n.useEffect(()=>{if(e.current){const n=e.current.getContext("2d"),i=t=>{const{top:r,left:n,width:o}=e.current.getBoundingClientRect(),a=o/e.current.width,i=t.touches?t.touches[0].clientX:t.clientX,l=t.touches?t.touches[0].clientY:t.clientY;return{x:(i-n)/a,y:(l-r)/a,unscaled:{x:i-n,y:l-r}}},l=e=>{0===e.button&&(e.preventDefault(),e.stopPropagation(),a=i(e))},c=e=>{if(a&&(s(a,i(e)),a=i(e)),r.current){const{unscaled:t}=i(e);r.current.style.left=t.x+"px",r.current.style.top=t.y+"px"}},u=e=>{c(e),a=null},s=(t,{x:r,y:o})=>{const a=e.current.getBoundingClientRect().width/e.current.width;n.save(),n.lineJoin="round",n.lineCap="round",n.beginPath(),n.lineWidth=2/a,n.strokeStyle="red",n.globalCompositeOperation="source-over",n.moveTo(t.x,t.y),n.lineTo(r,o),n.closePath(),n.stroke(),n.restore()};return o.attachHandlers(e,t,l,c,u)}},[e&&e.current,t&&t.current])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useEraser=void 0;const n=r(0),o=r(3);t.useEraser=(e,t,r)=>{let a=null;n.useEffect(()=>{if(e.current){const n=e.current.getContext("2d"),i=t=>{const{top:r,left:n,width:o}=e.current.getBoundingClientRect(),a=o/e.current.width,i=t.touches?t.touches[0].clientX:t.clientX,l=t.touches?t.touches[0].clientY:t.clientY;return{x:(i-n)/a,y:(l-r)/a,unscaled:{x:i-n,y:l-r}}},l=e=>{0===e.button&&(e.preventDefault(),e.stopPropagation(),a=i(e))},c=e=>{if(a&&(s(a,i(e)),a=i(e)),r.current){const{unscaled:t}=i(e);r.current.style.left=t.x+"px",r.current.style.top=t.y+"px"}},u=e=>{c(e),a=null},s=(t,{x:r,y:o})=>{const a=10/(e.current.getBoundingClientRect().width/e.current.width),i=t.x-r,l=t.y-o,c=a/2;if(Math.abs(i)>Math.abs(l)){const e=t.x<r?t.x:r,i=Math.round(t.x<r?r:t.x),l=t.x<r?t.y:o,u=(Math.round(t.x<r?o:t.y)-l)/(i-e);if(0===Math.round(u*(i-e)))n.clearRect(e-c,l-c,i-e+a,a);else{let t=0,r=0,o=e,s=Math.round(l);for(;e+t<i;)t+=1,s!==Math.round(u*t+l)&&(n.clearRect(o-c,s-c,t-r+c,a),s=Math.round(u*t+l),o+=t-r,r=t);t!==r&&n.clearRect(o-c,s-c,t-r+c,a)}}else{const e=t.y<o?t.x:r,i=Math.round(t.y<o?r:t.x),l=t.y<o?t.y:o,u=Math.round(t.y<o?o:t.y),s=(i-e)/(u-l);if(0===s)n.clearRect(e-c,l-c,a,u-l+a);else{let t=0,r=0,o=Math.round(e),i=l;for(;l+t<u;)t+=1,o!==Math.round(s*t+e)&&(n.clearRect(o-c,i-c,a,t-r+c),o=Math.round(s*t+e),i+=t-r,r=t);t!==r&&n.clearRect(o-c,i-c,a,t-r+c)}}};return o.attachHandlers(e,t,l,c,u)}},[e&&e.current,t&&t.current])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useBlackBox=void 0;const n=r(0),o=r(3);t.useBlackBox=(e,t,r)=>{let a=null,i=null;n.useEffect(()=>{if(e.current){const n=e.current.getContext("2d"),l=t=>{const{top:r,left:n,width:o}=e.current.getBoundingClientRect(),a=o/e.current.width,i=t.touches?t.touches[0].clientX:t.clientX,l=t.touches?t.touches[0].clientY:t.clientY;return{x:(i-n)/a,y:(l-r)/a,unscaled:{x:i-n,y:l-r}}},c=t=>{0===t.button&&(t.preventDefault(),t.stopPropagation(),a=l(t),i=n.getImageData(0,0,e.current.width,e.current.height))},u=e=>{if(a&&(n.putImageData(i,0,0),d(l(e))),r.current){const{unscaled:t}=l(e);r.current.style.left=t.x+"px",r.current.style.top=t.y+"px"}},s=e=>{u(e),a=null,i=null},d=({x:e,y:t})=>{const r=e<a.x?e:a.x,o=t<a.y?t:a.y,i=Math.abs(a.x-e),l=Math.abs(a.y-t);n.save(),n.fillStyle="black",n.fillRect(r,o,i,l),n.restore()};return o.attachHandlers(e,t,c,u,s)}},[e&&e.current,t&&t.current])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.postRequest=void 0,t.postRequest=(e,t)=>fetch(e,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify(t)}).then(e=>e.status<400?e.json():Promise.reject(e.json()))},function(e,t,r){"use strict";var n=r(1);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(r(0)),a=(0,n(r(2)).default)(o.default.createElement("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"InfoOutlined");t.default=a}])}));
//# sourceMappingURL=index.js.map